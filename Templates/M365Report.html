<html>
    <head>
        <style>
            h1
            {
                font-family: calibri, sans-serif;
                color: #2F5496;
                font-size: 18pt;
                font-weight: bold;
            }
            h2
            {
                font-family: calibri, sans-serif;
                color: #2F5496;
                font-size: 15pt;
            }
            h3
            {
                font-family: calibri, sans-serif;
                color: #2F5496;
                font-size: 12pt;
                margin-bottom: 2px;
            }
            h4
            {
                font-family: calibri, sans-serif;
                color: #2F5496;
                font-size: 12pt;
                margin-bottom: 2px;
            }
            .ContentColumn
            {
                border-style: solid;
                border-width: 1px; 
                box-shadow: 5px 5px 5px #888888;
                padding: 7px;
                margin-bottom: 5px;
            }
            .Icon
            {
                width: 17px;
                float: left;
                margin: 0 5px 0 0;
            }
            .Description
            {
                font-family: calibri, sans-serif;
                color:black;
                font-size: 8pt;
                text-align: left;
                font-style: italic;
                background-color: rgb(240, 240, 240);
                border-width: 1px;
                border-style: solid;
                padding:3px;
                margin-top: 5px;
            }
            .DataTable
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                margin-top: 0px;
                margin-bottom: 10px;
                border-collapse: collapse;
                width: 100%;
            }
            .DataTable th
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                padding: 2px;
            }
            .DataTable td
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                padding: 2px;
                text-align: center;
            }
            .LicenseTable
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                margin-top: 0px;
                margin-bottom: 10px;
                border-collapse: collapse;
                width: 100%;
                font-size: 10pt;
            }
            .LicenseTable th
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                padding: 2px;
            }
            .LicenseTable td
            {
                border-style: solid;
                border-width: 1px;
                border-color: black;
                padding: 2px;
                text-align: left;
            }
            .UsageTable
            {
                margin-top: 10px;
            }
            .UsageTable th
            {
                padding-right: 15px;
                text-align: left;
            }
            .UsageTable td
            {
                padding-right: 15px;
                text-align: left;
            }
            .UsageTable tr:nth-child(even)
            {
                /* background-color: #dddddd; */
            }
        </style>
    </head>
    <body style="font-size: 10pt; font-family: calibri, sans-serif;">

        <!-- Page 1 Header -->
        <table style="width: 210mm;">
            <tr>
                <td style="text-align: left;"">
                    <h1>[~CompanyName~] - Microsoft 365 Tenant Report</h1>
                </td>
                <td style="text-align: right;">
                    <img style="height: 50px;" src="https://raw.githubusercontent.com/computer-culture/public-content/master/Images/CCLBannerLogo.jpg">
                </td>
            </tr>
        </table>

        <!-- End of Page 1 Header -->

        <!-- Page 1 Content -->

        <table style="width: 210mm;">
            <tr>

                <!-- Left Column -->

                <td style="width: 50%;">
                    <div class="ContentColumn" style="height: 200mm;">
                        <h1 style="text-align: center;">Company Details</h1>
                        <p>
                            [~CompanyDetails~]
                        </p>

                        <h2>Cloud Data</h2>

                        <div class="TableHeading">
                            <img class="Icon" src="https://raw.githubusercontent.com/computer-culture/public-content/master/Images/Icons/MSIconOutlook.png" />
                            <h3>Mail</h3>
                        </div>
                        [~MailTable~]

                        <div class="TableHeading">
                            <img class="Icon" src="https://raw.githubusercontent.com/computer-culture/public-content/master/Images/Icons/MSIconTeams.png" />
                            <h3>Teams & SharePoint</h3>
                        </div>
                        [~SharePointTable~]

                        <div class="TableHeading">
                            <img class="Icon" src="https://raw.githubusercontent.com/computer-culture/public-content/master/Images/Icons/MSIconOneDrive.png" />
                            <h3>OneDrive</h3>
                        </div>
                        [~OneDriveTable~]

                        <h3>Licenses</h3>
                        [~LicensesTable~]

                    </div>
                </td>
                <td style="width:3px"></td>

                <!-- End of Left Column -->

                <!-- Right Column -->

                <td style="width: 50%;">
                    <div class="ContentColumn" style="height: 200mm;">
                        <h1 style="text-align: center;">Security</h1>

                        <h4>Microsoft Security Score</h4>

                            <div style="text-align: center; font-size: 32pt;">[~SecureScorePercent~]</div>
                            <div style="text-align: center; font-size: 10pt;">[~SecureScoreValues~]</div>
                            <div class="Description">Microsoft Secure Score is a measurement of an organization's security posture, with a higher number indicating that more improvement actions have been taken to increase security.</div>

                        <h4>Multifactor Authentication Status (MFA)</h4>

                        <table>
                            <tr>
                                <td><img class="Icon" src="[~MFAStatusIcon~]" /></td>
                                <td>[~MFAStatusDescription~]</td>
                            </tr>
                        </table>
                        
                        <div class="Description">Multi-factor authentication is a process where a user is prompted during the initial sign-in process for an additional form of identification, vastly increasing account security. It is considered a security baseline.</div>

                        <h4>Modern Authentication</h4>

                        <table>
                            <tr>
                                <td><img class="Icon" src="[~ModernAuthIcon~]" /></td>
                                <td>[~ModernAuthDescription~]</td>
                            </tr>
                        </table>

                        <div class="Description">The use of Modern authentication (as opposed to Legacy) ensures all devices connecting to your company resources can be secured using technologies like MFA. Conditional Access or Security Defaults can be used to block Legacy sign-ins.</div>

                        <h4>User Activity</h4>

                        <table>
                            <tr>
                                <td><img class="Icon" src="[~UserActivityIcon~]" /></td>
                                <td>[~UserActivityDescription~]</td>
                            </tr>
                        </table>

                        <div class="Description">Inactive accounts are accounts that have not been signed in to for 90 days. As they pose a security issue, they should be removed from your directory if no longer needed.</div>
                    </div>
                </td>

                <!-- End of Right Column -->

            </tr>
        </table>

        <!-- End of Page 1 Content -->

        <!-- Usage Content -->

        <table style="width: 210mm;">
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>Email Security</h2>
                        <div class="Description">
                            This is a list of all email enabled domain names in your Microsoft 365 tenant.
                            It is important they all have valid SPF and DKIM DNS records to prevent spoofing of your domain
                        </div>

                        [~Domains~]
            
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>Sign-in Information</h2>
                        <div class="Description">
                            This is a summary of sign-in information for your Microsoft 365 tenant.
                            Check for successful sign-ins from countries that should not be there, and for any Legacy protocols in use.
                            All sign-ins should be from apps that use Modern authentication. 
                            "Mobile Apps and Desktop Clients" includes apps such as the latest versions of Outlook for PC or Mobile,
                            or the latest versions of Mail for iOS and Gmail for Android.
                        </div>

                        [~SigninInfo~]
            
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>Inactive Users</h2>
                        <div class="Description">The following is a list of inactive users detected in your tenant that require attention.</div>

                        [~InactiveUsers~]
            
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>Mailbox Usage (Top 10)</h2>
                        <div class="Description">This report shows users with the highest usage on their mailboxes. If mailboxes are nearing capacity, solutions such as online archiving can be put in place, or mailboxes can be expanded if required. We monitor this usage and will advise if mailboxes approach quota limits.</div>

                        [~MailboxUsage~]
            
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>OneDrive Usage (Top 10)</h2>
                        <div class="Description">This report shows users with the highest data use in their OneDrive accounts. Excessive usage could be an indication staff are storing company files in their OneDrive accounts instead of company locations. We monitor this usage and will advise if it nears quota limits.</div>
                        
                        [~OneDriveUsage~]
            
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="ContentColumn">

                        <h2>Company SharePoint Sites</h2>
                        <div class="Description">This report shows all SharePoint / Teams sites in the company. Its a good reminder of where company data is stored online (if at all), and if any unneeded sites can be archived. We monitor usage on each site and will advise if any site nears its quota limits.</div>

                        [~SharePointUsage~]
            
                    </div>
                </td>
            </tr>
            
        </table>        

        <!-- End of Usage Content -->

    </body>
</html>